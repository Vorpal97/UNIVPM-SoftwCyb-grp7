<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet"href="https://localhost:10001/style">
</head>
<body>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script>
      fetch("https://localhost:10001/eventi")
        .then(function (response) {
          return response.json();
        })
        .then(function (myJson) {
          const tabellaEventi = document.querySelector("#eventi");
          $(document).ready(function () {
                var json = myJson;
                var tr;
                for (var i = 0; i < json.length; i++) {
                    tr = $('<tr/>');
                    tr.append("<td>" + json[i].nome + "</td>");
                    tr.append("<td>" + json[i].data + "</td>");
                    tr.append("<td>" + json[i].numPosti + "</td>");
                    tr.append("<td>" + json[i].postiDisponibili + "</td>");
                    tr.append("<td>" + json[i].prezzoBiglietto + "â‚¬" + "</td>");
                    tr.append("<td>" + json[i].ticketCounter + "</td>");
                    tr.append("<td>" + json[i].address + "</td>");
                    tr.append("<td>" + json[i].luogo + "</td>");
                    tr.append("<td>" + json[i].stato + "</td>");
                    if(json[i].stato == "inVendita"){
                      tr.append("<td><button class=\"bottone\" onClick = \"window.location.href='https://localhost:10001/acquistabiglietto?address=" + json[i].address + "'\" >Compra</button>" +
                                "</td>");
                    } else {
                      tr.append("<td><button class=\"bottoneDisabled\" onClick = \"window.location.href='https://localhost:10001/acquistabiglietto?address=" + json[i].address + "'\" disabled >Compra</button>" +
                                "</td>");

                    }


                    $('table').append(tr);
                }
        });

        })
        .catch(function (error) {
          console.log("Error: " + error);
        });
    </script>

<ul>
  <li><a href="https://localhost:10001/">Home</a></li>
  <li><a class="active" href="https://localhost:10001/visualizzaeventi">Visualizza eventi disponibili</a></li>
  <li><a href="https://localhost:10001/visualizzabiglietti">I miei biglietti</a></li>
</ul>

<div style="padding:20px;margin-top:30px;background-color:#1abc9c;height:1500px;">
  <div class="riquadro">

  <h1>Visualizza eventi</h1>

  <table id="eventi">
    <tr>
      <th>Nome dell'Evento</th>
      <th>Data</th>
      <th>Numero posti</th>
      <th>Posti disponibili</th>
      <th>Prezzo biglietto</th>
      <th>Biglietti venduti</th>
      <th>Indirizzo</th>
      <th>Luogo</th>
      <th>Stato</th>
      <th>Acquista</th>
    </tr>
  </table>

</div>
</div>

</body>
</html>
